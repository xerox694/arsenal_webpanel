<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Arsenal V4 WebPanel - Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/arsenal-styles.css">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #16213e;
            --primary-color: #00fff7;
            --secondary-color: #ff006e;
            --accent-color: #39ff14;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --border-color: #2a2a3e;
            --hover-color: rgba(0, 255, 247, 0.1);
            --success-color: #00ff41;
            --warning-color: #ffaa00;
            --error-color: #ff4757;
            --gold-color: #ffd700;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 255, 247, 0.3);
        }

        .dashboard-header h1 {
            color: var(--bg-primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .dashboard-header p {
            color: var(--bg-primary);
            opacity: 0.8;
            font-size: 1.1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            padding: 25px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease;
            text-align: center;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 10px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .analytics-card {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            padding: 25px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
        }

        .analytics-card h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .analytics-card div {
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .analytics-card div:last-child {
            border-bottom: none;
        }

        .bot-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .bot-status.online {
            background: linear-gradient(135deg, var(--success-color), rgba(0, 255, 65, 0.2));
        }

        .bot-status.offline {
            background: linear-gradient(135deg, var(--error-color), rgba(255, 71, 87, 0.2));
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-indicator.online {
            background: var(--success-color);
        }

        .status-indicator.offline {
            background: var(--error-color);
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }

        .loading i {
            font-size: 2rem;
            color: var(--primary-color);
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .dashboard-header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-header">
        <h1>üöÄ Arsenal V4 Dashboard</h1>
        <p>Syst√®me de contr√¥le avanc√©</p>
    </div>

    <!-- Statut du Bot -->
    <div class="bot-status" id="botStatus">
        <div class="status-indicator" id="statusIndicator"></div>
        <span id="statusText">V√©rification du statut...</span>
    </div>

    <!-- Statistiques principales -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üë•</div>
            <div class="stat-value" id="total-users">--</div>
            <div class="stat-label">Utilisateurs Total</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <div class="stat-value" id="servers-count">--</div>
            <div class="stat-label">Serveurs Connect√©s</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">‚ö°</div>
            <div class="stat-value" id="commands-count">--</div>
            <div class="stat-label">Commandes Ex√©cut√©es</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üü¢</div>
            <div class="stat-value" id="active-users">--</div>
            <div class="stat-label">Utilisateurs Actifs</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üìà</div>
            <div class="stat-value" id="active-7days">--</div>
            <div class="stat-label">Actifs 7 jours</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üÜï</div>
            <div class="stat-value" id="new-users">--</div>
            <div class="stat-label">Nouveaux Utilisateurs</div>
        </div>
    </div>

    <!-- Analytics d√©taill√©es -->
    <div class="analytics-grid">
        <div class="analytics-card">
            <h3>üìä Performance Syst√®me</h3>
            <div id="cpu-usage">CPU: --</div>
            <div id="ram-usage">RAM: --</div>
            <div id="uptime">Uptime: --</div>
            <div id="discord-latency">Latency Discord: --</div>
        </div>
        <div class="analytics-card">
            <h3>üéÆ Activit√© Bot</h3>
            <div id="users-count">Utilisateurs connect√©s: --</div>
            <div id="commands-today">Commandes aujourd'hui: --</div>
            <div id="bot-uptime">Uptime bot: --</div>
            <div id="last-restart">Dernier red√©marrage: --</div>
        </div>
    </div>

    <div id="loadingIndicator" class="loading">
        <div><i class="fas fa-spinner"></i></div>
        <p>Chargement des donn√©es...</p>
    </div>

    <script>
        console.log('üöÄ Arsenal V4 WebPanel\\nDeveloped by XeRoX ¬© 2024-2025\\nAll Rights Reserved');
        console.log('üöÄ Arsenal Dashboard - D√©marrage...');

        // Fonction utilitaire pour mettre √† jour les √©l√©ments
        function updateElement(id, value) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value;
                console.log(`üîß √âl√©ment mis √† jour: ${id} = ${value}`);
            } else {
                console.warn(`‚ö†Ô∏è √âl√©ment non trouv√©: ${id}`);
            }
        }

        // Fonction pour masquer le loading
        function hideLoading() {
            const loading = document.getElementById('loadingIndicator');
            if (loading) {
                loading.style.display = 'none';
            }
        }

        // Fonction pour afficher une notification
        function showNotification(message, type = 'info') {
            console.log(`üì¢ ${type.toUpperCase()}: ${message}`);
        }

        // Chargement des statistiques
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                
                if (data.success) {
                    console.log('üìä Stats re√ßues:', data.stats);
                    const stats = data.stats;
                    
                    updateElement('total-users', stats.total_users || 0);
                    updateElement('servers-count', stats.servers_count || 0);
                    updateElement('commands-count', stats.commands_executed || 0);
                    updateElement('active-users', stats.active_users || 0);
                    updateElement('active-7days', stats.active_7days || 0);
                    updateElement('new-users', stats.new_users || 0);
                }
            } catch (error) {
                console.error('‚ùå Erreur chargement stats:', error);
            }
        }

        // Chargement des donn√©es de performance
        async function loadPerformance() {
            try {
                const response = await fetch('/api/performance');
                const data = await response.json();
                
                if (data.success) {
                    console.log('üñ•Ô∏è Performance re√ßue:', data.data);
                    const perf = data.data;
                    
                    updateElement('cpu-usage', `CPU: ${perf.cpu_usage}%`);
                    updateElement('ram-usage', `RAM: ${perf.ram_usage}%`);
                    updateElement('uptime', `Uptime: ${perf.uptime}`);
                    updateElement('discord-latency', `Latency: ${perf.discord_latency}ms`);
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è Performance indisponible:', error);
                updateElement('cpu-usage', 'CPU: --');
                updateElement('ram-usage', 'RAM: --');
                updateElement('uptime', 'Uptime: --');
                updateElement('discord-latency', 'Latency: --');
            }
        }

        // Chargement du statut bot
        async function loadBotStatus() {
            try {
                const response = await fetch('/api/bot/status');
                const data = await response.json();
                
                if (data.success) {
                    console.log('ü§ñ Bot Status re√ßu:', data.status);
                    const status = data.status;
                    
                    const botStatusDiv = document.getElementById('botStatus');
                    const statusIndicator = document.getElementById('statusIndicator');
                    const statusText = document.getElementById('statusText');
                    
                    if (status.online) {
                        botStatusDiv.className = 'bot-status online';
                        statusIndicator.className = 'status-indicator online';
                        statusText.textContent = `üü¢ Bot en ligne - ${status.servers_connected} serveurs`;
                    } else {
                        botStatusDiv.className = 'bot-status offline';
                        statusIndicator.className = 'status-indicator offline';
                        statusText.textContent = 'üî¥ Bot hors ligne';
                    }
                    
                    updateElement('bot-uptime', status.uptime || '--');
                    updateElement('last-restart', status.last_restart || '--');
                    updateElement('users-count', status.users_count || '--');
                    updateElement('commands-today', status.commands_today || '--');
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è Statut bot indisponible:', error);
                const botStatusDiv = document.getElementById('botStatus');
                const statusIndicator = document.getElementById('statusIndicator');
                const statusText = document.getElementById('statusText');
                
                botStatusDiv.className = 'bot-status offline';
                statusIndicator.className = 'status-indicator offline';
                statusText.textContent = 'üî¥ Statut indisponible';
            }
        }

        // Fonction principale de chargement
        async function loadDashboard() {
            console.log('üîÑ Chargement du dashboard...');
            
            try {
                // Charger toutes les donn√©es en parall√®le
                await Promise.all([
                    loadStats(),
                    loadPerformance(),
                    loadBotStatus()
                ]);
                
                hideLoading();
                console.log('‚úÖ Dashboard charg√© avec succ√®s');
                
            } catch (error) {
                console.error('‚ùå Erreur chargement dashboard:', error);
                hideLoading();
            }
        }

        // Actualisation automatique
        function startAutoRefresh() {
            // Actualiser toutes les 30 secondes
            setInterval(() => {
                console.log('üîÑ Actualisation automatique...');
                loadDashboard();
            }, 30000);
        }

        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initialisation du dashboard...');
            loadDashboard();
            startAutoRefresh();
        });

        // Fonction pour cr√©er la page analytics (r√©f√©renc√©e dans les erreurs)
        function createAnalyticsPage() {
            return document.querySelector('.analytics-grid') || document.createElement('div');
        }
    </script>
</body>
</html>
